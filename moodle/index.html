
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.3.5">
    
    
      
        <title>Moodle - Knowledge Base</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4a0965b7.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../_custom/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="red">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#moodle" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Knowledge Base" class="md-header__button md-logo" aria-label="Knowledge Base" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Knowledge Base
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Moodle
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Knowledge Base" class="md-nav__button md-logo" aria-label="Knowledge Base" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Knowledge Base
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Welcome to Knowledge Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../linux/" class="md-nav__link">
        Linux
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Networking
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Networking" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Networking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hub-switch-router/" class="md-nav__link">
        Hub, Switch and Router
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../network-models/" class="md-nav__link">
        Network Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cables-and-interfaces/" class="md-nav__link">
        Cables and Interfaces
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ipv6/" class="md-nav__link">
        IPv6
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../docker/" class="md-nav__link">
        Docker
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Moodle
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Moodle
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#upgrade-moodle-from-31-to-311" class="md-nav__link">
    Upgrade moodle from 3.1 to 3.11
  </a>
  
    <nav class="md-nav" aria-label="Upgrade moodle from 3.1 to 3.11">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#upgrade-to-moodle-36" class="md-nav__link">
    Upgrade to moodle 3.6
  </a>
  
    <nav class="md-nav" aria-label="Upgrade to moodle 3.6">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backup-mysql-database" class="md-nav__link">
    Backup MySql database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backup-moodledata-directory" class="md-nav__link">
    Backup Moodledata directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backup-moodle-code" class="md-nav__link">
    Backup Moodle Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-innodb-tables-to-barracuda" class="md-nav__link">
    Converting InnoDB tables to Barracuda
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-to-the-new-character-set-and-collation-do-this-with-moodle-36" class="md-nav__link">
    Converting to the new character set and collation [do this with moodle 3.6]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-mariadb-version-to-56-102" class="md-nav__link">
    Update Mariadb version to 5.6 (/10.2)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-mariadb-102" class="md-nav__link">
    Install MariaDB 10.2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upgrade-php-version-to-72" class="md-nav__link">
    Upgrade PHP version to 7.2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-new-moodle-software" class="md-nav__link">
    Install the new Moodle software
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#upgrade-moodle-from-31-to-311" class="md-nav__link">
    Upgrade moodle from 3.1 to 3.11
  </a>
  
    <nav class="md-nav" aria-label="Upgrade moodle from 3.1 to 3.11">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#upgrade-to-moodle-36" class="md-nav__link">
    Upgrade to moodle 3.6
  </a>
  
    <nav class="md-nav" aria-label="Upgrade to moodle 3.6">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#backup-mysql-database" class="md-nav__link">
    Backup MySql database
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backup-moodledata-directory" class="md-nav__link">
    Backup Moodledata directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#backup-moodle-code" class="md-nav__link">
    Backup Moodle Code
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-innodb-tables-to-barracuda" class="md-nav__link">
    Converting InnoDB tables to Barracuda
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-to-the-new-character-set-and-collation-do-this-with-moodle-36" class="md-nav__link">
    Converting to the new character set and collation [do this with moodle 3.6]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-mariadb-version-to-56-102" class="md-nav__link">
    Update Mariadb version to 5.6 (/10.2)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-mariadb-102" class="md-nav__link">
    Install MariaDB 10.2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upgrade-php-version-to-72" class="md-nav__link">
    Upgrade PHP version to 7.2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-the-new-moodle-software" class="md-nav__link">
    Install the new Moodle software
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="moodle">Moodle</h1>
<h2 id="upgrade-moodle-from-31-to-311">Upgrade moodle from 3.1 to 3.11</h2>
<p>Moodle 3.1 system 
MySql 5.5.68
Php 5.4.16
Apache 2.4.6
OS: Centos7</p>
<p>We can not directly update moodle from 3.1 version to 3.11 version. First we have to get moodle into intermediate version (moodle version 3.6) and then we can upgrade it to moodle version 3.11.</p>
<h3 id="upgrade-to-moodle-36">Upgrade to moodle 3.6</h3>
<p>Reference:</p>
<p><a href="https://docs.moodle.org/36/en/Upgrading#Moodle_3.1.2C_3.2.2C_3.3.2C_3.4_and_3.5_improvements">https://docs.moodle.org/36/en/Upgrading#Moodle_3.1.2C_3.2.2C_3.3.2C_3.4_and_3.5_improvements</a></p>
<p><a href="https://docs.moodle.org/31/en/Upgrading">https://docs.moodle.org/31/en/Upgrading</a></p>
<p>Before upgrading, check that your server meets all requirements for 3.6 in Site administration &gt; Server &gt; Environment.</p>
<p>Put moodle in maintenance mood.</p>
<pre><code>Site administration &gt; server &gt; Maintenance Mode
</code></pre>
<p>Set upgrade key in config.php file. (Optional)</p>
<pre><code>$CFG-&gt;upgradekey = ‘Put upgrade key here’; Also take a copy/screen shot of config.php file)
</code></pre>
<pre><code>- [https://docs.moodle.org/36/en/Upgrade_key](https://docs.moodle.org/36/en/Upgrade_key)
</code></pre>
<p>Backup important data.</p>
<pre><code>- [https://docs.moodle.org/36/en/Site_backup](https://docs.moodle.org/36/en/Site_backup)
</code></pre>
<p>Three parts needed to be backed-up.</p>
<ol>
<li>The data stored in the database (For example, a MySQL database)</li>
<li>The uploaded files (For example, site and course files uploaded via Moodle located in moodledata)</li>
<li>The Moodle code (For example, everything in server/htdocs/moodle)</li>
</ol>
<h5 id="backup-mysql-database">Backup MySql database</h5>
<p>(Using mysqldump Tool)
Create a directory as /opt/backup/sqlfiles/
Goto above directory. Cd /opt/backup/sqlfiles/
Run mysqldump tool.</p>
<pre><code>Sudo mysqldump -u root --password=PUT_PASSWORD_HERE -C -Q -e --create-options DB_NAME_HERE &gt; moodle-database.sql
</code></pre>
<p>[ If above not worked</p>
<pre><code>Sudo mysqldump --single-transaction -u root --password=PUT_PASSWORD_HERE -C -Q -e --create-options DB_NAME_HERE &gt; moodle-database.sql
</code></pre>
<p>]</p>
<pre><code>gzip moodle-database.sql
</code></pre>
<p>To check the file size use </p>
<pre><code>du -sh &lt;directry_name&gt;
</code></pre>
<h5 id="backup-moodledata-directory">Backup Moodledata directory</h5>
<p>Backup using Filezilla</p>
<h5 id="backup-moodle-code">Backup Moodle Code</h5>
<p>Backup using Filezilla</p>
<ul>
<li><a href="https://www.educative.io/edpresso/how-to-gzip-a-directory-in-linux">https://www.educative.io/edpresso/how-to-gzip-a-directory-in-linux</a></li>
</ul>
<h4 id="converting-innodb-tables-to-barracuda">Converting InnoDB tables to Barracuda</h4>
<ul>
<li><a href="https://docs.moodle.org/311/en/Administration_via_command_line">https://docs.moodle.org/311/en/Administration_via_command_line</a></li>
</ul>
<p>Sites using MySQL with database tables using Antelope as the file format are recommended to convert the tables to the Barracuda file format. </p>
<p>This can be achieve running the mysql_compressed_rows.php script in moodle/admin/cli directory.</p>
<p>It should be run as </p>
<pre><code>sudo -u apache /usr/bin/php admin/cli/php_script_name
</code></pre>
<pre><code>. (user should change working directory to www/http/moodle before run the scripts)
</code></pre>
<p>To get help run below command.</p>
<pre><code>sudo -u apache /usr/bin/php admin/cli/php_script_name --help
</code></pre>
<pre><code>sudo -u apache /usr/bin/php admin/cli/mysql_compressed_rows.php --list
</code></pre>
<p>This will view the tables requiring conversion.</p>
<p>To proceed with the conversion, run the command using the fix option: </p>
<pre><code>sudo -u apache /usr/bin/php admin/cli/mysql_compressed_rows.php --fix
</code></pre>
<p>Successful table conversion will be reported in the output.</p>
<p>If the fix command not worked and an error like below arises, follow the below steps.
Error:</p>
<p>[show warnings; to see the mysql warnings]</p>
<p>Cannot enable GLOBAL innodb_file_per_table setting, use --showsql option and execute the statements manually. !!! Error writing to database !!!</p>
<pre><code>sudo -u apache /usr/bin/php admin/cli/mysql_compressed_rows.php --help
sudo -u apache /usr/bin/php admin/cli/mysql_compressed_rows.php --showsql
</code></pre>
<p>(--showsql flag will show the sql queries which need to be run manually)</p>
<p>Run the required sql statements with root privileges.</p>
<h4 id="converting-to-the-new-character-set-and-collation-do-this-with-moodle-36">Converting to the new character set and collation [do this with moodle 3.6]</h4>
<p>Run the below command as above.</p>
<pre><code>sudo -u apache /usr/bin/php admin/cli/mysql_collation.php --collation=utf8mb4_unicode_ci
</code></pre>
<p>Adjust the $CFG-&gt;dboptions Array in your config.php to make sure that Moodle uses the right Collation when connecting to the MySQL Server:</p>
<pre><code>$CFG-&gt;dboptions = array(
  …
  'dbcollation' =&gt; 'utf8mb4_unicode_ci',
  …
);
</code></pre>
<p>If the fix command not worked and an error like below arise, follow the below steps.</p>
<p>Error: ‘utf8mb4_unicode_ci’ requires the setting ‘innodb_large_prefix’ be set to ‘ON’.
An attempt was made to change the format, but it failed. Please try doing this manually.</p>
<p>Run the below sql statement with root privileges.</p>
<pre><code>SET GLOBAL innodb_large_prefix = 'on'
</code></pre>
<p>Now run the </p>
<pre><code>sudo -u apache /usr/bin/php admin/cli/mysql_collation.php --collation=utf8mb4_unicode_ci
</code></pre>
<p>command again.</p>
<p>For more info <a href="https://docs.moodle.org/31/en/MySQL_full_unicode_support">https://docs.moodle.org/31/en/MySQL_full_unicode_support</a></p>
<hr />
<p>Get a backup of sql moodle db using below command.</p>
<pre><code>Sudo mysqldump -u root --password=PUT_PASSWORD_HERE -default-character-set=utf8mb4 -C -Q -e --create-options DB_NAME_HERE &gt; moodle-database.sql
</code></pre>
<p><a href="https://webmasters.stackexchange.com/questions/100648/character-set-utf-8-is-not-a-compiled-character-set-and-is-not-specified-in-th">https://webmasters.stackexchange.com/questions/100648/character-set-utf-8-is-not-a-compiled-character-set-and-is-not-specified-in-th</a></p>
<hr />
<h4 id="update-mariadb-version-to-56-102">Update Mariadb version to 5.6 (/10.2)</h4>
<p>Stop mariadb service    </p>
<pre><code>sudo systemctl stop mariadb
</code></pre>
<p>List all mariadb rpm packages    </p>
<pre><code>rpm -qa | grep mariadb
</code></pre>
<p>Remove MariaDB 5.5.x packages:    </p>
<pre><code>sudo yum remove mariadb mariadb-server mariadb-libs
</code></pre>
<p>Add a new MariaDB repository:</p>
<pre><code>vi /etc/yum.repos.d/mariadb.repo
</code></pre>
<pre><code>[mariadb]
name = MariaDB
baseurl = http://yum.mariadb.org/10.2/centos7-amd64
gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDB
gpgcheck=1
</code></pre>
<p>Clean the repository cache on your server with:</p>
<pre><code>yum clean all
</code></pre>
<h4 id="install-mariadb-102">Install MariaDB 10.2</h4>
<pre><code>sudo yum install MariaDB-client MariaDB-server
</code></pre>
<p>Please note, you need to install Postfix and php-mysql packages if you used them prior this upgrade, so run:</p>
<pre><code>sudo yum install postfix php-mysql
</code></pre>
<p>Enable MariaDB service to automatically start on server boot:</p>
<pre><code>systemctl enable mariadb
</code></pre>
<p>Start the MariaDB service:</p>
<pre><code>systemctl start mariadb
</code></pre>
<p>Run the mysql_upgrade command-line command to examine all tables in all MariaDB databases for incompatibilities with the currently installed version of the MariaDB server:</p>
<pre><code>sudo mysql_upgrade -u root -p
</code></pre>
<pre><code>sudo systemctl restart httpd
</code></pre>
<p><a href="https://linuxhostsupport.com/blog/how-to-upgrade-mariadb-on-centos-7/">https://linuxhostsupport.com/blog/how-to-upgrade-mariadb-on-centos-7/
</a></p>
<h4 id="upgrade-php-version-to-72">Upgrade PHP version to 7.2</h4>
<pre><code>php -v
</code></pre>
<p>Output:</p>
<pre><code>PHP 5.4.16 (cli) (built: Nov 1 2019 16:04:20) 
Copyright (c) 1997-2013 The PHP Group
Zend Engine v2.4.0, Copyright (c) 1998-2013 Zend Technologies
</code></pre>
<p>Turn on Remi repo:</p>
<pre><code>sudo yum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm
</code></pre>
<p>Install yum-utils packages:</p>
<pre><code>sudo yum install yum-utils
</code></pre>
<p>The yum-utils package includes yum-config-manager, which you can use to enable Remi repo as the default repository for installing different PHP versions.</p>
<pre><code>sudo yum-config-manager --enable remi-php72
sudo yum update
php -v
Systemctl restart httpd
</code></pre>
<p>(At this point moodle will not work)</p>
<h4 id="install-the-new-moodle-software">Install the new Moodle software</h4>
<p>Rename old moodle software folder in /var/www/html/ folder to moodle.old3_6 using below command</p>
<pre><code>sudo mv moodle moodle.old3_6
</code></pre>
<p>Create folder(moodle_3_6)  in /opt to download new moodle3.6 software.
You can fetch the current version of the software through</p>
<pre><code>wget http://sourceforge.net/projects/moodle/files/Moodle/stable36/moodle-latest-36.tgz
</code></pre>
<p>You may need to install the wget tool using the sudo yum install wget command.</p>
<p>This will download moodle-latest-36.tgz tar file.</p>
<p>To unpack this file use the below command.</p>
<pre><code>sudo tar zxvf moodle-latest-36.tgz
</code></pre>
<p><a href="https://www.cyberciti.biz/faq/unpack-tgz-linux-command-line/">https://www.cyberciti.biz/faq/unpack-tgz-linux-command-line/</a></p>
<p>This will create a moodle file containing new moodle 3.6 software.
Copy this folder to /var/www/html/ directory using </p>
<pre><code>sudo cp -R moodle /var/www/html/ command.
</code></pre>
<p>Copy your old config.php file back to the new Moodle directory.</p>
<pre><code>Sudo cp config.php /var/www/html/moodle/ (To run this command you need to be inside of the old moodle directory)
</code></pre>
<p>Don't forget to make moodle/config.php (and the rest of the source code) readable by your www server. For maximum security the files should not be writeable by your server. This is especially important on a 'production' server open to the public internet.</p>
<pre><code>chown -R root:root moodle (Linux debian - or even create a user especially for moodle. Don't use the web server user, e.g. www-data)
chmod -R 755 moodle  (In above both commands, moodle is the folder name which is located inside the web root directory.)
</code></pre>
<p>Now visit  [http://moodle_server_ip/moodle]http://moodle_server_ip/moodle</p>
<p>To install zip extension package</p>
<p>[https://www.programmersought.com/article/94124969653/]https://www.programmersought.com/article/94124969653/</p>
<p><a href="https://stackoverflow.com/questions/49583881/how-can-i-install-ziparchive-on-php-7-2-with-centos-7">https://stackoverflow.com/questions/49583881/how-can-i-install-ziparchive-on-php-7-2-with-centos-7</a></p>
<pre><code>sudo yum install php-pecl-zip
sudo systemctl restart httpd
PHP setting-&gt; opcache.enable
Use the below command to install opcache extension.
sudo yum install php-pecl-zendopcache
sudo systemctl restart httpd
</code></pre>
<p>Converting to the new character set and collation
[This section NOT Worked]</p>
<p>Upgrade to Moodle 3.11
Follow update guide
Tack backups of moodle db, moodledata and moodle (3.6) code</p>
<p><a href="https://docs.moodle.org/311/en/Upgrading">https://docs.moodle.org/311/en/Upgrading</a></p>
<p>Update php 7.2 to php 7.3</p>
<p>First disable remi-php72</p>
<pre><code>sudo yum-config-manager --disable remi-php54
</code></pre>
<p>Enable remi-php74</p>
<pre><code>sudo yum-config-manager --enable remi-php74
Sudo yum update
</code></pre>
<p>Restart apache and mariadb</p>
<p>Refresh and check if the moodle environment requirements are all set.</p>
<p>Download new moodle software.</p>
<pre><code>wget http://sourceforge.net/projects/moodle/files/Moodle/stable311/moodle-latest-311.tgz
This will download moodle-latest-311.tgz tar file.
</code></pre>
<p>To unpack this file use the below command.</p>
<pre><code>sudo tar zxvf moodle-latest-311.tgz
</code></pre>
<p>Rename old moodle software folder in /var/www/html/ folder to moodle.old3_6 using below command</p>
<pre><code>Sudo mv moodle moodle.old3_6
</code></pre>
<p>This will create a moodle file containing new moodle 3.6 software.
Copy this folder to /var/www/html/ directory using </p>
<pre><code>sudo cp -R moodle /var/www/html/ command.
</code></pre>
<p>Copy your old config.php file back to the new Moodle directory.</p>
<pre><code>chown -R root:root moodle (Linux debian - or even create a user especially for moodle. Don't use the web server user, e.g. www-data)
chmod -R 755 moodle
</code></pre>
<p>--- For mysql ---</p>
<p><a href="https://plenium.wordpress.com/2018/07/01/upgrade-mysql-5-6-to-5-7-on-centos-7/">https://plenium.wordpress.com/2018/07/01/upgrade-mysql-5-6-to-5-7-on-centos-7/</a></p>
<p><a href="https://www.linuxhelp.com/questions/mysqldump-couldn-t-execute-show-variables-like-gtid-mode-table-performance-schema-session-variables-doesn-t-exist-1146">https://www.linuxhelp.com/questions/mysqldump-couldn-t-execute-show-variables-like-gtid-mode-table-performance-schema-session-variables-doesn-t-exist-1146</a></p>
<p>--File copy--</p>
<p><a href="https://askubuntu.com/questions/86822/how-can-i-copy-the-contents-of-a-folder-to-another-folder-in-a-different-directo">https://askubuntu.com/questions/86822/how-can-i-copy-the-contents-of-a-folder-to-another-folder-in-a-different-directo</a></p>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../docker/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Docker" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Docker
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant"], "search": "../assets/javascripts/workers/search.85cb4492.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.431f3d41.min.js"></script>
      
    
  </body>
</html>